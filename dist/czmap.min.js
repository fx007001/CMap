!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).CMap=t()}(this,(function(){"use strict";function e(){var e=window.BMapGL||{},t=window.BMapGLLib||{},o=this.$options,i=o.points,n=void 0===i?[116.404,39.915]:i,a=o.areaName,r=o.poiText,l=void 0===r||r,s=o.poiIcon,p=void 0===s||s,d=o.zoom,c=void 0===d?10:d,g=o.drivingPath,v=void 0===g?[]:g,h=o.enableScrollWheel,m=void 0!==h&&h,w=o.isScaleCtrl,y=void 0!==w&&w,f=o.isZoomCtrl,u=void 0!==f&&f,C=o.navi3DCtrl,M=void 0!==C&&C,k=o.enclosure,L=void 0===k?{}:k,A=o.drivingType,b=new e.Map(o.id),T=this.$options.points&&2===n.length?new e.Point(n[0],n[1]):null;if(b.centerAndZoom(null!=T?T:a,c),b.enableScrollWheelZoom(m),b.setDisplayOptions({poiText:l,poiIcon:p}),M){var P=new e.NavigationControl3D;b.addControl(P)}if(y){var O=new e.ScaleControl;b.addControl(O)}if(u){var F=new e.ZoomControl;b.addControl(F)}if(v&&v.length>=2){var B=[v[0].lng,v[0].lat],E=[v.at(-1).lng,v.at(-1).lat];if(A&&"path"===A){var S=new e.Point(B[0],B[1]),D=new e.Point(E[0],E[1]);new e.DrivingRoute(b,{renderOptions:{map:b,autoViewport:!0}}).search(S,D)}else{b.centerAndZoom(new e.Point(B[0],B[1]));for(var W=[],z=0;v.length>z;z++)W.push(new e.Point(v[z].lng,v[z].lat));var x=new e.Polyline(W,{strokeColor:"#6699FF",strokeWeight:6}),I=new e.Marker(new e.Point(B[0],B[1]),{title:"起点"}),_=new e.Marker(new e.Point(E[0],E[1]),{title:"终点"});setTimeout((function(){new t.TrackAnimation(b,x,{overallView:!0,tilt:30,duration:4e3,delay:300}).start(),b.addOverlay(I),b.addOverlay(_)}),1e3)}}if(L&&"circle"===L.type||L&&L.point){var G=L.fillColor,Z=void 0===G?"#6699FF":G,$=L.fillOpacity,j=void 0===$?.3:$,V=L.strokeColor,q=void 0===V?"#6699FF":V,N=L.strokeWeight,R=void 0===N?2:N,U=L.strokeOpacity,K=void 0===U?1:U,H=L.point,J=L.radius,Q=new e.Circle(new e.Point(H[0],H[1]),J,{fillColor:Z,fillOpacity:j,strokeColor:q,strokeWeight:R,strokeOpacity:K});b.addOverlay(Q)}else if(L&&L.points||L&&"polygon"===L.type){var Y=L.fillColor,X=(Z=void 0===Y?"#6699FF":Y,L.fillOpacity),ee=(j=void 0===X?.3:X,L.strokeColor),te=(q=void 0===ee?"#6699FF":ee,L.strokeWeight),oe=(R=void 0===te?2:te,L.strokeOpacity),ie=(K=void 0===oe?1:oe,L.points),ne=void 0===ie?[]:ie,ae=[];for(z=0;ne.length>z;z++)ae.push(new e.Point(ne[z].lng,ne[z].lat));var re=new e.Polygon(ae,{fillColor:Z,fillOpacity:j,strokeColor:q,strokeWeight:R,strokeOpacity:K});b.addOverlay(re)}}function t(){var e=window.AMap||{},t=this.$options,o=t.points,i=t.zoom,n=t.isScaleCtrl,a=void 0!==n&&n,r=t.isZoomCtrl,l=void 0!==r&&r,s=t.navi3DCtrl,p=void 0!==s&&s,d=t.enclosure,c=void 0===d?{}:d,g=t.drivingType,v=t.drivingPath,h=void 0===v?[]:v,m=new e.Map(t.id,{center:void 0===o?[116.404,39.915]:o,resizeEnable:!0,zoom:void 0===i?10:i});if(a&&m.addControl(new e.Scale({visible:a})),l&&m.addControl(new e.ToolBar({visible:l,position:{bottom:"60px",right:"40px"}})),p&&m.addControl(new e.MapType),"path"===g&&h.length>2&&e.plugin(["AMap.DragRoute"],(function(){for(var t=[],o=0;h.length>o;o++)t.push([h[o].lng,h[o].lat]);new e.DragRoute(m,t,e.DrivingPolicy.LEAST_FEE).search()})),h&&h.length>2){for(var w=[],y=0;h.length>y;y++)w.push(new e.LngLat(h[y].lng,h[y].lat));var f=new e.Polyline({path:w,strokeColor:"#6699FF",strokeWeight:6,strokeOpacity:.9,zIndex:50,bubble:!0}),u=new e.Icon({size:new e.Size(25,34),image:"//a.amap.com/jsapi_demos/static/demo-center/icons/dir-marker.png",imageSize:new e.Size(135,40),imageOffset:new e.Pixel(-9,-3)}),C=new e.Marker({position:new e.LngLat(h[0].lng,h[0].lat),icon:u,offset:new e.Pixel(-13,-30)}),M=new e.Icon({size:new e.Size(25,34),image:"//a.amap.com/jsapi_demos/static/demo-center/icons/dir-marker.png",imageSize:new e.Size(135,40),imageOffset:new e.Pixel(-95,-3)}),k=h.at(-1),L=new e.Marker({position:new e.LngLat(k.lng,k.lat),icon:M,offset:new e.Pixel(-13,-30)});m.add(C),m.add(f),m.add(L),m.setFitView()}if(c&&c.points){var A=c.points,b=c.fillColor,T=void 0===b?"#6699FF":b,P=c.fillOpacity,O=void 0===P?.3:P,F=c.strokeColor,B=void 0===F?"#6699FF":F,E=c.borderWeight,S=void 0===E?2:E;for(w=[],y=0;A.length>y;y++)w.push(new e.LngLat(A[y].lng,A[y].lat));var D=new e.Polygon({path:w,fillColor:T,borderWeight:S,strokeColor:B,fillOpacity:O});m.add(D),m.setFitView()}if(c&&c.point){var W=c.point,z=c.radius,x=c.fillColor,I=(T=void 0===x?"#6699FF":x,c.fillOpacity),_=(O=void 0===I?.3:I,c.strokeColor),G=(B=void 0===_?"#6699FF":_,c.strokeWeight),Z=void 0===G?2:G,$=new e.Circle({center:new e.LngLat(W[0],W[1]),radius:z,fillColor:T,fillOpacity:O,strokeColor:B,strokeWeight:Z});m.add($),m.setFitView()}}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function o(e,t,o){if(o||2===arguments.length)for(var i,n=0,a=t.length;a>n;n++)!i&&n in t||(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))}function i(){var e=window.TMap||{},t=this.$options,i=t.id,n=void 0===i?"map":i,a=t.points,r=void 0===a?[116.307503,39.984104]:a,l=t.zoom,s=void 0===l?10:l,p=t.isScaleCtrl,d=void 0!==p&&p,c=t.isZoomCtrl,g=void 0!==c&&c,v=t.navi3DCtrl,h=void 0!==v&&v,m=t.drivingPath,w=void 0===m?[]:m,y=t.enclosure,f=void 0===y?{}:y,u=new e.LatLng(r[1],r[0]),C=new e.Map(document.getElementById(n),{center:u,zoom:s});if(g||C.removeControl(e.constants.DEFAULT_CONTROL_ID.ZOOM),d||C.removeControl(e.constants.DEFAULT_CONTROL_ID.SCALE),h||C.removeControl(e.constants.DEFAULT_CONTROL_ID.ROTATION),w&&w.length>=2){var M=[];w.forEach((function(t){M.push(new e.LatLng(t.lat,t.lng))}));var k=w.at(-1),L=new e.LatLng(w[0].lat,w[0].lng),A=new e.LatLng(k.lat,k.lng);new e.MultiMarker({id:"marker-layer",map:C,styles:{start:new e.MarkerStyle({width:25,height:35,anchor:{x:16,y:32},src:"https://mapapi.qq.com/web/lbs/javascriptGL/demo/img/start.png"}),end:new e.MarkerStyle({width:25,height:35,anchor:{x:16,y:32},src:"https://mapapi.qq.com/web/lbs/javascriptGL/demo/img/end.png"})},geometries:[{id:"start",styleId:"start",position:L},{id:"end",styleId:"end",position:A}]}),new e.MultiPolyline({id:"polyline-layer",map:C,styles:{style_blue:new e.PolylineStyle({color:"#3777FF",width:6,lineCap:"round"})},geometries:[{id:"pl_1",styleId:"style_blue",paths:M}]}),S(E(M))}if(f&&f.points){var b=f.radius,T=f.strokeColor,P=f.strokeWeight,O=[];f.points.forEach((function(t){O.push(new e.LatLng(t.lat,t.lng))})),new e.MultiPolygon({id:"polygon-layer",map:C,styles:{polygon:new e.PolygonStyle({color:"rgba(0,125,255,0.3)",showBorder:!0,borderColor:T||"#6699FF"})},geometries:[{id:"polygon",styleId:"polygon",paths:O,properties:{title:"polygon"}}]}),S(E(O)),C.setCenter(O[0])}if(f&&f.point){var F=f.point,B=(b=f.radius,T=f.strokeColor,P=f.strokeWeight,new e.LatLng(F[1],F[0]));new e.MultiCircle({map:C,styles:{circle:new e.CircleStyle({color:"rgba(41,91,255,0.3)",showBorder:!0,borderColor:T||"rgba(41,91,255,1)",borderWidth:P})},geometries:[{styleId:"circle",center:B,radius:b}]}),S({distance:2*b,cent:B})}function E(t){var i=[],n=[],a=[],r=[];t.forEach((function(e){(void 0===i[0]||e.lat>i[0])&&(i[0]=e.lat),(void 0===i[1]||i[1]>e.lng)&&(i[1]=e.lng),(void 0===n[0]||n[0]>e.lat)&&(n[0]=e.lat),(void 0===n[1]||e.lng>n[1])&&(n[1]=e.lng),(void 0===a[0]||e.lat>a[0])&&(a[0]=e.lat),(void 0===a[1]||e.lng>a[1])&&(a[1]=e.lng),(void 0===r[0]||r[0]>e.lat)&&(r[0]=e.lat),(void 0===r[1]||r[1]>e.lng)&&(r[1]=e.lng)}));var l=[new e.LatLng(i[0],i[1]),new e.LatLng(n[0],n[1])],s=e.geometry.computeDistance(l),p=o(o([],l,!0),[new e.LatLng(a[0],a[1]),new e.LatLng(r[0],r[1])],!1),d="";try{d=e.geometry.computeCentroid(p)}catch(e){d=void 0}return{distance:s.toFixed(2),cent:d}}function S(e){var t=e.distance,o=e.cent;if(console.log(t,o),o&&(console.log(2,t,o),C.setCenter(o)),t){C.setZoom(80>t?16:t>80&&1e3>t?15:t>1e3&&3e3>t?14:t>3e3&&7e3>t?13:t>7e3&&15e3>t?12:10)}}}return function(){function o(n){this.initBMap=e,this.initAMap=t,this.initTMap=i,this.$options=n,this.mapAk="";var a=n.type;o.wd.$catch&&o.wd.$catch===a?a&&"TMAP"===a?this.initTMap():a&&"AMAP"===a?this.initAMap():a&&"BMAP"===a&&this.initBMap():this.initMap()}return o.prototype.initMap=function(){var e=this.$options.type;this.getMapAK(e),window.$catch=e,e&&"TMAP"===e?this.createTMap():e&&"AMAP"===e?this.createAMap():e&&"BMAP"===e&&this.createBMap()},o.prototype.getMapAK=function(e){var t=this.$options.mapAk;if(t)this.mapAk=t;else switch(e){case"TMAP":this.mapAk="OB4BZ-D4W3U-B7VVO-4PJWW-6TKDJ-WPB77";break;case"AMAP":this.mapAk="c081218aae02057742b9f1a100d6cf66";break;default:this.mapAk="f7HnzEYGLgOyMyDVTh99ZEQqjlEzuhyC"}},o.prototype.createBMap=function(){var e=this,t=window||{},o=this.$options.drivingPath,i=document.createElement("link");i.setAttribute("rel","stylesheet"),i.setAttribute("type","text/css"),i.setAttribute("href","http://api.map.baidu.com/res/webgl/10/bmap.css"),document.getElementsByTagName("head")[0].appendChild(i);var n=document.createElement("script");if(n.src="http://api.map.baidu.com/getscript?type=webgl&v=1.0&ak=".concat(e.mapAk,"&services=&t=").concat((new Date).getTime()),document.body.appendChild(n),t.BMapGL_loadScriptTime=(new Date).getTime(),t.BMapGL=t.BMapGL||{},t.BMapGL.apiLoad=function(){delete t.BMapGL.apiLoad,"function"==typeof e.initBMap&&e.initBMap()},o&&o.length>=2){var a=document.createElement("script");a.src="//mapopen.bj.bcebos.com/github/BMapGLLib/TrackAnimation/src/TrackAnimation.min.js",document.body.appendChild(a)}},o.prototype.createAMap=function(){console.log("高德");var e=this,t="https://webapi.amap.com/maps?v=2.0&key=".concat(e.mapAk,"&&plugin=AMap.Scale,AMap.HawkEye,AMap.ToolBar,AMap.MapType"),o=document.createElement("script");o.src=t,document.body.appendChild(o),o.onload=function(){console.log(112,window),e.initAMap()}},o.prototype.createTMap=function(){var e=this,t="https://map.qq.com/api/gljs?v=1.exp&key=".concat(e.mapAk),o=document.createElement("script");o.src=t,document.body.appendChild(o),o.onload=function(){e.initTMap()}},o.wd=window||{},o}()}));
