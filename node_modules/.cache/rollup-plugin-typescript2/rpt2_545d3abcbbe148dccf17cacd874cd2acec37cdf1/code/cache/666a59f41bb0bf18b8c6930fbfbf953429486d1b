{"code":"import { initBMap as initBMapFn } from './BMap';\r\nimport { initAMap as initAMapFn } from './AMap';\r\nimport { initTMap as initTMapFn } from './TMap';\r\nexport default class CMap {\r\n    constructor(options) {\r\n        // 初始百度地图 - 抹平API操作\r\n        this.initBMap = initBMapFn;\r\n        // 初始化高德地图 - 抹平API操作\r\n        this.initAMap = initAMapFn;\r\n        // 初始腾讯德地图 - 抹平API操作\r\n        this.initTMap = initTMapFn;\r\n        this.$options = options;\r\n        this.mapAk = '';\r\n        this.initMap();\r\n    }\r\n    // 初始化地图 \r\n    initMap() {\r\n        const { type } = this.$options;\r\n        this.getMapAK(type);\r\n        if (type && type === 'TMAP') {\r\n            this.createTMap();\r\n        }\r\n        else if (type && type === 'AMAP') {\r\n            this.createAMap();\r\n        }\r\n        else if (type && type === 'BMAP') {\r\n            this.createBMap();\r\n        }\r\n    }\r\n    // 获取地图的ak\r\n    getMapAK(type) {\r\n        const { mapAk } = this.$options;\r\n        if (mapAk) {\r\n            this.mapAk = mapAk;\r\n        }\r\n        else {\r\n            switch (type) {\r\n                case 'TMAP': {\r\n                    this.mapAk = 'OB4BZ-D4W3U-B7VVO-4PJWW-6TKDJ-WPB77';\r\n                    break;\r\n                }\r\n                case 'AMAP': {\r\n                    this.mapAk = 'c081218aae02057742b9f1a100d6cf66';\r\n                    break;\r\n                }\r\n                default: {\r\n                    this.mapAk = 'f7HnzEYGLgOyMyDVTh99ZEQqjlEzuhyC';\r\n                }\r\n            }\r\n        }\r\n    }\r\n    // 初始化百度地图\r\n    createBMap() {\r\n        const self = this, wd = window || {};\r\n        const { drivingPath } = this.$options;\r\n        wd.BMapGL_loadScriptTime = (new Date).getTime();\r\n        wd.BMapGL = wd.BMapGL || {};\r\n        wd.BMapGL.apiLoad = function () {\r\n            delete wd.BMapGL.apiLoad;\r\n            if (typeof self.initBMap == \"function\") {\r\n                self.initBMap();\r\n            }\r\n        };\r\n        const s = document.createElement('script');\r\n        s.src = `http://api.map.baidu.com/getscript?type=webgl&v=1.0&ak=${self.mapAk}&services=&t=${(new Date).getTime()}`;\r\n        document.body.appendChild(s);\r\n        const link = document.createElement('link');\r\n        link.setAttribute('rel', 'stylesheet');\r\n        link.setAttribute('type', 'text/css');\r\n        link.setAttribute('href', 'http://api.map.baidu.com/res/webgl/10/bmap.css');\r\n        document.getElementsByTagName('head')[0].appendChild(link);\r\n        if (drivingPath && drivingPath.length >= 2) {\r\n            const trackAnim = document.createElement('script');\r\n            trackAnim.src = `//mapopen.bj.bcebos.com/github/BMapGLLib/TrackAnimation/src/TrackAnimation.min.js`;\r\n            document.body.appendChild(trackAnim);\r\n        }\r\n    }\r\n    // 初始化高德地图 - 加载\r\n    createAMap() {\r\n        console.log('高德');\r\n        const self = this;\r\n        const url = `https://webapi.amap.com/maps?v=2.0&key=${self.mapAk}&&plugin=AMap.Scale,AMap.HawkEye,AMap.ToolBar,AMap.MapType`;\r\n        const jsapi = document.createElement('script');\r\n        jsapi.src = url;\r\n        document.body.appendChild(jsapi);\r\n        jsapi.onload = function () {\r\n            console.log(112, window);\r\n            self.initAMap();\r\n        };\r\n    }\r\n    // 初始化腾讯地图 - 加载\r\n    createTMap() {\r\n        const self = this;\r\n        const url = `https://map.qq.com/api/gljs?v=1.exp&key=${self.mapAk}`;\r\n        const jsapi = document.createElement('script');\r\n        jsapi.src = url;\r\n        document.body.appendChild(jsapi);\r\n        jsapi.onload = function () {\r\n            self.initTMap();\r\n        };\r\n    }\r\n}\r\n","references":["/Users/itcast_web/Desktop/CMap/src/BMap.ts","/Users/itcast_web/Desktop/CMap/src/AMap.ts","/Users/itcast_web/Desktop/CMap/src/TMap.ts","/Users/itcast_web/Desktop/CMap/src/types/options.ts"]}
